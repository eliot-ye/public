<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <div style="display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 100vh;">
    <div>page 2 go <a href="./index.html">page 1</a></div>
    <button id="btn-biometrics">Click biometrics</button>
    <div
      style="padding: 20px; display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 10px;">
      <span id="has-biometrics"></span>
      <span id="result" style="word-wrap: normal;"></span>
    </div>
    <button id="btn-reset">Click reset</button>
  </div>
</body>
<script>
  // window.biometrics = function ({ promptMessage } = {}) {
  //   return new Promise((resolve, reject) => {
  //     const id = Math.random().toString(36).slice(-8) + '_' + new Date().getTime()
  //     window[id] = function (data) {
  //       if (data.type === 'biometrics' && data.id === id) {
  //         if (data.statusCode === 'SUC200') {
  //           resolve(data.verifySuccess);
  //         } else {
  //           reject({ statusCode: data.statusCode, error: data.error });
  //         }
  //       }
  //     }
  //     window.ReactNativeWebView.postMessage(JSON.stringify({ type: 'biometrics', id, promptMessage }));
  //   })
  // }

  if (window.biometrics) {
    document.getElementById('has-biometrics').innerText = "has biometrics"
  }
  document.getElementById('btn-biometrics').addEventListener('click', async () => {
    if (window.biometrics) {
      try {
        /** @type {(option?: {promptMessage: string;}) => Promise<{id: string; type: string; success: boolean; error?: string}>} */
        const biometrics = window.biometrics
        const resultObject = await biometrics({ promptMessage: 'promptMessage test' })
        document.getElementById('result').innerHTML = JSON.stringify(resultObject)
      } catch (error) {
        document.getElementById('result').innerHTML = JSON.stringify(error)
      }
    }
  })

  document.getElementById('btn-reset').addEventListener('click', () => {
    window.location.reload()
  })
</script>

</html>